<section class="bg bg-light py-5">
    <div class="card m-auto p-5 col-11 col-xxl-10">

        <div class="d-flex align-items-center mb-5">
            <p class="h1 fw-normal display-5 m-0 ms-3"> Companies </p>
            <div class="ms-auto">

                <button mat-fab color="accent" class="me-2" (click)="openFilterSection()"
                    [ngClass]="{'shadow-none': !viewFilterSection, 'shadow-xxl': viewFilterSection}">
                    <mat-icon>search</mat-icon>
                </button>

                <button mat-fab color="accent" class="ms-2" (click)="openViewOptions()"
                    [ngClass]="{'shadow-none': !viewOptions, 'shadow-xxl': viewOptions}">
                    <mat-icon>more_vert</mat-icon>
                </button>

                <div [class.d-none]="!viewFilterSection"
                    class="card border p-2 col-4 col-xxl-3 col-xxl-4 lh-lg ms-auto me-5 position-absolute end-0 z-1">
                    <p class="h5 p-3 m-0">Filter Section</p>
                    <!-- <hr class="hr col-10 m-auto mt-2 mb-3"> -->
                    <mat-divider class="col-10 m-auto mt-2 mb-3"></mat-divider>
                    <div class="d-flex flex-column align-items-center">

                        <!-- <div class="d-flex flex-column col-10">
                            <label class="fw-bold">Name:</label>
                            <input class="ps-3 py-2 border border-dark rounded" type="text" name="search"
                                [(ngModel)]="filterName" placeholder="Search by name ...">
                        </div> -->
                        <div class="d-flex flex-column col-10 mt-3">
                            <mat-form-field class="example-form-field">
                                <mat-label>Search by name:</mat-label>
                                <input matInput type="text" [(ngModel)]="filterName">
                                <button *ngIf="filterName" matSuffix mat-icon-button aria-label="Clear"
                                    (click)="filterName=''">
                                    <mat-icon>close</mat-icon>
                                </button>
                            </mat-form-field>
                        </div>

                        <!-- <div class="d-flex flex-column col-10 my-3">
                            <label class="fw-bold">E-mail:</label>
                            <input class="ps-3 py-2 border border-dark rounded" type="text" name="search"
                                [(ngModel)]="filterEmail" placeholder="Search by e-mail ...">
                        </div> -->

                        <div class="d-flex flex-column col-10 my-3">
                            <mat-form-field class="example-form-field">
                                <mat-label>Search by e-mail:</mat-label>
                                <input matInput type="text" [(ngModel)]="filterEmail">
                                <button *ngIf="filterEmail" matSuffix mat-icon-button aria-label="Clear"
                                    (click)="filterEmail=''">
                                    <mat-icon>close</mat-icon>
                                </button>
                            </mat-form-field>
                        </div>

                        <!-- <div class="d-flex flex-column col-10 mb-3">
                            <label class="fw-bold">Vat:</label>
                            <input class="ps-3 py-2 border border-dark rounded" type="text" name="search"
                                [(ngModel)]="filterVat" placeholder="Search by vat ...">
                        </div> -->

                        <div class="d-flex flex-column col-10 mb-3">
                            <mat-form-field class="example-form-field">
                                <mat-label>Search by vat:</mat-label>
                                <input matInput type="text" [(ngModel)]="filterVat">
                                <button *ngIf="filterVat" matSuffix mat-icon-button aria-label="Clear"
                                    (click)="filterVat=''">
                                    <mat-icon>close</mat-icon>
                                </button>
                            </mat-form-field>
                        </div>

                        <!-- <div class="d-flex flex-column col-10">
                            <label class="fw-bold">Phone:</label>
                            <input class="ps-3 py-2 border border-dark rounded" type="text" name="search"
                                [(ngModel)]="filterPhone" placeholder="Search by phone ...">
                        </div> -->

                        <div class="d-flex flex-column col-10">
                            <mat-form-field class="example-form-field">
                                <mat-label>Search by phone number:</mat-label>
                                <input matInput type="text" [(ngModel)]="filterPhone">
                                <button *ngIf="filterPhone" matSuffix mat-icon-button aria-label="Clear"
                                    (click)="filterPhone=''">
                                    <mat-icon>close</mat-icon>
                                </button>
                            </mat-form-field>
                        </div>

                        <div class="d-flex flex-column col-10 my-3">
                            <mat-form-field appearance="fill">
                                <mat-label>Select a state</mat-label>
                                <mat-select [(ngModel)]="selectedCountry">
                                    <mat-option value=""><span class="fw-bold">All state</span></mat-option>
                                    <mat-option *ngFor="let country of uniqueCountries" [value]="country">{{ country
                                        }}</mat-option>
                                </mat-select>
                            </mat-form-field>

                        </div>

                        <!-- <div class="d-flex flex-column col-10 justify-content-center align-items-center">
                            <label class="fw-bold align-self-start" for="state-select">Select a state</label>
                            <select class="form-select border border-dark ps-3 py-2" [(ngModel)]="selectedCountry"
                                aria-label="Default select example">
                                <option selected>All state</option>
                                <option *ngFor="let country of uniqueCountries">{{country}}</option>
                            </select>
                        </div> -->

                        <div class="d-flex justify-content-between col-10 mb-3 mt-2">
                            <button mat-flat-button class="bg bg-dark text-light col-6" (click)="searchButton()">Search
                                <i class="fa-solid fa-search ms-1"></i></button>
                            <button mat-flat-button class="bg bg-danger text-light col-4"
                                (click)="resetAllFilter()">Reset <i class="fa-solid fa-trash ms-1"></i></button>
                        </div>

                    </div>

                </div>

                <div *ngIf="viewOptions"
                    class="card border p-2 col-3 col-xxl-2 lh-lg ms-auto me-5 position-absolute end-0 z-1">

                    <p class="h5 p-3 m-0">View Options</p>
                    <mat-divider class="col-10 m-auto mt-2 mb-3"></mat-divider>
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <p class="text-muted m-0 ps-2">
                            Shown
                        </p>
                        <button class="btn shadow-none text-danger m-0 me-1 p-1 hoverLight" (click)="hideAll()">
                            Hide all
                        </button>
                    </div>
                    <div *ngIf="visibleColumns[0]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">#</p> <button class="btn p-0 shadow-none" (click)="isColumnVisible(0)"><i
                                class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[0], 'fa-eye-slash': !visibleColumns[0]}"></i></button>

                    </div>
                    <div *ngIf="visibleColumns[1]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">Name</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(1)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[1], 'fa-eye-slash': !visibleColumns[1]}"></i></button>
                    </div>
                    <div *ngIf="visibleColumns[2]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">E-mail</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(2)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[2], 'fa-eye-slash': !visibleColumns[2]}"></i></button>
                    </div>
                    <div *ngIf="visibleColumns[3]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">Vat</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(3)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[3], 'fa-eye-slash': !visibleColumns[3]}"></i></button>
                    </div>
                    <div *ngIf="visibleColumns[4]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">Phone Number</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(4)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[4], 'fa-eye-slash': !visibleColumns[4]}"></i></button>
                    </div>
                    <div *ngIf="visibleColumns[5]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">Country</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(5)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[5], 'fa-eye-slash': !visibleColumns[5]}"></i></button>
                    </div>
                    <div *ngIf="visibleColumns[6]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">Street</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(6)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[6], 'fa-eye-slash': !visibleColumns[6]}"></i></button>
                    </div>
                    <div *ngIf="visibleColumns[7]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">Website</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(7)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[7], 'fa-eye-slash': !visibleColumns[7]}"></i></button>
                    </div>

                    <mat-divider class="col-10 m-auto my-3"></mat-divider>
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <p class="text-muted m-0 ps-2">
                            Hidden
                        </p>

                        <button class="btn shadow-none text-primary m-0 ms-1 me-2 p-1 hoverLight"
                            (click)="displayAll()">
                            Display all
                        </button>
                    </div>

                    <div *ngIf="!visibleColumns[0]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">#</p> <button class="btn p-0 shadow-none" (click)="isColumnVisible(0)"><i
                                class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[0], 'fa-eye-slash': !visibleColumns[0]}"></i></button>

                    </div>
                    <div *ngIf="!visibleColumns[1]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">Name</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(1)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[1], 'fa-eye-slash': !visibleColumns[1]}"></i></button>
                    </div>
                    <div *ngIf="!visibleColumns[2]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">E-mail</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(2)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[2], 'fa-eye-slash': !visibleColumns[2]}"></i></button>
                    </div>
                    <div *ngIf="!visibleColumns[3]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">Vat</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(3)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[3], 'fa-eye-slash': !visibleColumns[3]}"></i></button>
                    </div>
                    <div *ngIf="!visibleColumns[4]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">Phone Number</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(4)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[4], 'fa-eye-slash': !visibleColumns[4]}"></i></button>
                    </div>
                    <div *ngIf="!visibleColumns[5]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">Country</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(5)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[5], 'fa-eye-slash': !visibleColumns[5]}"></i></button>
                    </div>
                    <div *ngIf="!visibleColumns[6]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">Street</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(6)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[6], 'fa-eye-slash': !visibleColumns[6]}"></i></button>
                    </div>
                    <div *ngIf="!visibleColumns[7]"
                        class="d-flex align-items-center justify-content-between rounded py-1 px-3 hover">
                        <p class="m-0 fw-bold">Website</p> <button class="btn p-0 shadow-none"
                            (click)="isColumnVisible(7)"><i class="fa-regular fs-5"
                                [ngClass]="{'fa-eye': visibleColumns[7], 'fa-eye-slash': !visibleColumns[7]}"></i></button>
                    </div>

                </div>
            </div>

        </div>
        <div *ngIf="filterBoxWithResults" class="d-flex mb-3">
            <!-- <div *ngIf="filterBoxName" class="mt-2">
                <button type="button" class="btn btn-outline-dark rounded-pill d-flex" (click)="removeFilterName()"
                    style="background-color: rgba(0, 0, 0, 0.10);">
                    <p class="m-0 me-1 text-lowercase">name: </p> <span class="fw-bold"> {{filterChipsForName}}</span>
                    <i class="fa-solid fa-x ms-2 ps-1 align-self-center"></i>
                </button>
            </div> -->

            <div *ngIf="filterBoxName" class="mt-2" #chipGrid>
                <mat-chip-row>
                    <p class="ps-1 m-0 me-1 text-lowercase">name:
                        <span class="fw-bold"> {{filterChipsForName}}</span>
                    </p>
                    <button (click)="removeFilterName()" matChipRemove>
                        <mat-icon>cancel</mat-icon>
                    </button>
                </mat-chip-row>
            </div>

            <!-- <div *ngIf="filterBoxEmail" class="mt-2 ms-2">
                <button type="button" class="btn btn-outline-dark rounded-pill d-flex" (click)="removeFilterEmail()"
                    style="background-color: rgba(0, 0, 0, 0.10);">
                    <p class="m-0 me-1 text-lowercase">e-mail: </p> <span class="fw-bold">
                        {{filterChipsForEmail}}</span> <i class="fa-solid fa-x ms-2 ps-1 align-self-center"></i>
                </button>
            </div> -->

            <div *ngIf="filterBoxEmail" class="mt-2 ms-2" #chipGrid>
                <mat-chip-row>
                    <p class="ps-1 m-0 me-1 text-lowercase">e-mail:
                        <span class="fw-bold"> {{filterChipsForEmail}}</span>
                    </p>
                    <button (click)="removeFilterEmail()" matChipRemove>
                        <mat-icon>cancel</mat-icon>
                    </button>
                </mat-chip-row>
            </div>

            <!-- <div *ngIf="filterBoxVat" class="mt-2 ms-2">
                <button type="button" class="btn btn-outline-dark rounded-pill d-flex" (click)="removeFilterVat()"
                    style="background-color: rgba(0, 0, 0, 0.10);">
                    <p class="m-0 me-1 text-lowercase">vat: </p> <span class="fw-bold">
                        {{filterChipsForVat}}</span> <i class="fa-solid fa-x ms-2 ps-1 align-self-center"></i>
                </button>
            </div> -->

            <div *ngIf="filterBoxVat" class="mt-2 ms-2" #chipGrid>
                <mat-chip-row>
                    <p class="ps-1 m-0 me-1 text-lowercase">vat:
                        <span class="fw-bold"> {{filterChipsForVat}}</span>
                    </p>
                    <button (click)="removeFilterVat()" matChipRemove>
                        <mat-icon>cancel</mat-icon>
                    </button>
                </mat-chip-row>
            </div>

            <!-- <div *ngIf="filterBoxPhone" class="mt-2 ms-2">
                <button type="button" class="btn btn-outline-dark rounded-pill d-flex" (click)="removeFilterPhone()"
                    style="background-color: rgba(0, 0, 0, 0.10);">
                    <p class="m-0 me-1 text-lowercase">phone number: </p> <span class="fw-bold">
                        {{filterChipsForPhone}}</span> <i class="fa-solid fa-x ms-2 ps-1 align-self-center"></i>
                </button>
            </div> -->

            <div *ngIf="filterBoxPhone" class="mt-2 ms-2" #chipGrid>
                <mat-chip-row>
                    <p class="ps-1 m-0 me-1 text-lowercase">phone number:
                        <span class="fw-bold"> {{filterChipsForPhone}}</span>
                    </p>
                    <button (click)="removeFilterPhone()" matChipRemove>
                        <mat-icon>cancel</mat-icon>
                    </button>
                </mat-chip-row>
            </div>

            <!-- <div *ngIf="filterBoxCountry" class="mt-2 ms-2">
                <button type="button" class="btn btn-outline-dark rounded-pill d-flex" (click)="removeFilterCountry()"
                    style="background-color: rgba(0, 0, 0, 0.10);">
                    <p class="m-0 me-1 text-lowercase">country: </p> <span class="fw-bold">
                        {{filterChipsForCountry}}</span> <i class="fa-solid fa-x ms-2 ps-1 align-self-center"></i>
                </button>
            </div> -->

            <div *ngIf="filterBoxCountry" class="mt-2 ms-2" #chipGrid>
                <mat-chip-row>
                    <p class="ps-1 m-0 me-1 text-lowercase">country:
                        <span class="fw-bold"> {{filterChipsForCountry}}</span>
                    </p>
                    <button (click)="removeFilterCountry()" matChipRemove>
                        <mat-icon>cancel</mat-icon>
                    </button>
                </mat-chip-row>
            </div>

            <p class="m-0 ms-3 mt-3 fw-bold">{{filteredCompanies.data.length}} Results</p>
        </div>

        <div *ngIf="loading" class="d-flex justify-content-center align-items-center">
            <button class="btn btn-light" type="button" disabled>
                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                Loading...
            </button>
        </div>

        <section class="z-0" tabindex="0">

            <table class="shadow-none z-0" mat-table [dataSource]="filteredCompanies.data">

                <!-- <th *ngIf="visibleColumns[1]" scope="col" style="font-weight:bolder">Name</th>
                <th *ngIf="visibleColumns[2]" scope="col" style="font-weight:bolder">E-mail</th>
                <th *ngIf="visibleColumns[3]" scope="col" style="font-weight:bolder">Vat</th>
                <th *ngIf="visibleColumns[4]" scope="col" style="font-weight:bolder">Phone number</th>
                <th *ngIf="visibleColumns[5]" scope="col" style="font-weight:bolder">Country</th>
                <th *ngIf="visibleColumns[6]" scope="col" style="font-weight:bolder">Street</th>
                <th *ngIf="visibleColumns[7]" scope="col" style="font-weight:bolder">Website</th> -->

                <!-- Position Column -->
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef scope="col" style="font-weight:bolder"> # </th>
                    <td mat-cell *matCellDef="let company"> {{company.id}} </td>
                </ng-container>

                <!-- Name Column -->
                <ng-container matColumnDef="Name">
                    <th mat-header-cell *matHeaderCellDef> Name </th>
                    <td mat-cell *matCellDef="let company"> {{company.name}} </td>
                </ng-container>

                <!-- E-mail Column -->
                <ng-container matColumnDef="E-mail">
                    <th mat-header-cell *matHeaderCellDef> E-mail </th>
                    <td mat-cell *matCellDef="let company"> {{company.email}} </td>
                </ng-container>

                <!-- Vat Column -->
                <ng-container matColumnDef="Vat">
                    <th mat-header-cell *matHeaderCellDef> Vat </th>
                    <td mat-cell *matCellDef="let company"> {{company.vat}} </td>
                </ng-container>

                <!-- Phone number Column -->
                <ng-container matColumnDef="Phone number">
                    <th mat-header-cell *matHeaderCellDef> Phone number </th>
                    <td mat-cell *matCellDef="let company"> {{company.phone}} </td>
                </ng-container>

                <!-- Country Column -->
                <ng-container matColumnDef="Country">
                    <th mat-header-cell *matHeaderCellDef> Country </th>
                    <td mat-cell *matCellDef="let company"> {{company.country}} </td>
                </ng-container>

                <!-- Street Column -->
                <ng-container matColumnDef="Street">
                    <th mat-header-cell *matHeaderCellDef> Street </th>
                    <td mat-cell *matCellDef="let company"> {{company.addresses[0].street}} </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns, sticky: true"></tr>
                <tr mat-row matRipple [matRippleRadius]="20" (click)="openCompanyDetails(row,'250ms', '250ms')"
                    *matRowDef="let row; columns: displayedColumns;">
                </tr>
            </table>
        </section>
    </div>
</section>